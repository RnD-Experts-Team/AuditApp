import{c as Pe,r as P,j as t,a as He,H as Ve}from"./app-BUKQPHa7.js";import{A as Be}from"./app-layout-Cqm7Iojn.js";import{c as Me}from"./button-eUTeR7b1.js";import{R as Je}from"./refresh-cw-Cgmoq7Q4.js";import"./app-D3mE4-U5.js";import"./index-AiCtM_xl.js";import"./index-qi8lqJb0.js";import"./index-TbakzgMN.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Qe=Me("Download",Ke);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Ye=Me("Filter",Xe);function bt(l){const e=Pe.c(123),{auth:x,reportData:Ue,stores:Se,groups:we,ratings:ke,filters:h}=l,[i,Ae]=P.useState(h.report_type||""),[n,Ee]=P.useState(h.store_id||""),[o,Ie]=P.useState(h.group||""),[a,Ge]=P.useState(h.date_from||""),[c,$e]=P.useState(h.date_to||""),[d,Le]=P.useState(h.rating_id||"");let V;e[0]!==a||e[1]!==c||e[2]!==o||e[3]!==d||e[4]!==i||e[5]!==n?(V=()=>{He.get("/camera-reports",{report_type:i,store_id:n,group:o,date_from:a,date_to:c,rating_id:d},{preserveState:!0,preserveScroll:!0})},e[0]=a,e[1]=c,e[2]=o,e[3]=d,e[4]=i,e[5]=n,e[6]=V):V=e[6];const Re=V;let B;e[7]===Symbol.for("react.memo_cache_sentinel")?(B=()=>{Ae(""),Ee(""),Ie(""),Ge(""),$e(""),Le(""),He.get("/camera-reports")},e[7]=B):B=e[7];const We=B;let J;e[8]!==a||e[9]!==c||e[10]!==o||e[11]!==d||e[12]!==i||e[13]!==n?(J=()=>{const s=new URLSearchParams;i&&s.set("report_type",i),n&&s.set("store_id",String(n)),o&&s.set("group",String(o)),a&&s.set("date_from",a),c&&s.set("date_to",c),d&&s.set("rating_id",String(d));const r=`/camera-reports/export?${s.toString()}`;window.location.href=r},e[8]=a,e[9]=c,e[10]=o,e[11]=d,e[12]=i,e[13]=n,e[14]=J):J=e[14];const Ce=J,qe=ot,{summary:m,entities:Te,total_stores:De,scoreData:g}=Ue;let Fe;e:{if(!m?.length){let r;e[15]===Symbol.for("react.memo_cache_sentinel")?(r=[],e[15]=r):r=e[15],Fe=r;break e}let s;if(e[16]!==Te||e[17]!==m){let r;e[19]!==m?(r=O=>m.some(p=>{const ze=p.entities?.[O.id];return ze?.rating_counts?.length?ze.rating_counts.some(nt):!1}),e[19]=m,e[20]=r):r=e[20],s=Te.filter(r),e[16]=Te,e[17]=m,e[18]=s}else s=e[18];Fe=s}const f=Fe;let K;if(e[21]!==f){const s={};f.forEach(r=>{const O=r.category?.id??0,p=r.category?.label??"Uncategorized";s[p]||(s[p]={id:O,label:p,entities:[]}),s[p].entities.push(r)}),K=Object.values(s).filter(it),e[21]=f,e[22]=K}else K=e[22];const u=K,Oe=x.user;let Q;e[23]===Symbol.for("react.memo_cache_sentinel")?(Q=t.jsx(Ve,{title:"Camera Reports"}),e[23]=Q):Q=e[23];let X;e[24]===Symbol.for("react.memo_cache_sentinel")?(X=t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Camera Reports"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Summary of ratings per store and entity"})]}),e[24]=X):X=e[24];let Y;e[25]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx(Qe,{className:"h-4 w-4"}),e[25]=Y):Y=e[25];let b;e[26]!==Ce?(b=t.jsxs("div",{className:"flex items-center justify-between",children:[X,t.jsxs("button",{onClick:Ce,className:"inline-flex items-center gap-2 justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 transition-colors",children:[Y,"Export"]})]}),e[26]=Ce,e[27]=b):b=e[27];let Z;e[28]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-accent/10 px-6 py-4 border-b",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ye,{className:"h-5 w-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"Filters"})]})}),e[28]=Z):Z=e[28];let ee;e[29]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx("label",{className:"text-sm font-medium",children:"Report Type"}),e[29]=ee):ee=e[29];let te;e[30]===Symbol.for("react.memo_cache_sentinel")?(te=s=>Ae(s.target.value),e[30]=te):te=e[30];let se,le,re;e[31]===Symbol.for("react.memo_cache_sentinel")?(se=t.jsx("option",{value:"",children:"All Types"}),le=t.jsx("option",{value:"main",children:"Main"}),re=t.jsx("option",{value:"secondary",children:"Secondary"}),e[31]=se,e[32]=le,e[33]=re):(se=e[31],le=e[32],re=e[33]);let _;e[34]!==i?(_=t.jsxs("div",{className:"space-y-2",children:[ee,t.jsxs("select",{value:i,onChange:te,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[se,le,re]})]}),e[34]=i,e[35]=_):_=e[35];let ie;e[36]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx("label",{className:"text-sm font-medium",children:"Store"}),e[36]=ie):ie=e[36];let ne;e[37]===Symbol.for("react.memo_cache_sentinel")?(ne=s=>Ee(s.target.value),e[37]=ne):ne=e[37];let oe;e[38]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx("option",{value:"",children:"All Stores"}),e[38]=oe):oe=e[38];let j;e[39]!==Se?(j=Se.map(rt),e[39]=Se,e[40]=j):j=e[40];let y;e[41]!==n||e[42]!==j?(y=t.jsxs("div",{className:"space-y-2",children:[ie,t.jsxs("select",{value:n,onChange:ne,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[oe,j]})]}),e[41]=n,e[42]=j,e[43]=y):y=e[43];let ae;e[44]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx("label",{className:"text-sm font-medium",children:"Group"}),e[44]=ae):ae=e[44];let ce;e[45]===Symbol.for("react.memo_cache_sentinel")?(ce=s=>Ie(s.target.value),e[45]=ce):ce=e[45];let de;e[46]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx("option",{value:"",children:"All Groups"}),e[46]=de):de=e[46];let v;e[47]!==we?(v=we.map(lt),e[47]=we,e[48]=v):v=e[48];let N;e[49]!==o||e[50]!==v?(N=t.jsxs("div",{className:"space-y-2",children:[ae,t.jsxs("select",{value:o,onChange:ce,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[de,v]})]}),e[49]=o,e[50]=v,e[51]=N):N=e[51];let me;e[52]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx("label",{className:"text-sm font-medium",children:"Rating"}),e[52]=me):me=e[52];let fe;e[53]===Symbol.for("react.memo_cache_sentinel")?(fe=s=>Le(s.target.value),e[53]=fe):fe=e[53];let ue;e[54]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx("option",{value:"",children:"All Ratings"}),e[54]=ue):ue=e[54];let S;e[55]!==ke?(S=ke.map(st),e[55]=ke,e[56]=S):S=e[56];let w;e[57]!==d||e[58]!==S?(w=t.jsxs("div",{className:"space-y-2",children:[me,t.jsxs("select",{value:d,onChange:fe,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[ue,S]})]}),e[57]=d,e[58]=S,e[59]=w):w=e[59];let k;e[60]!==_||e[61]!==y||e[62]!==N||e[63]!==w?(k=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[_,y,N,w]}),e[60]=_,e[61]=y,e[62]=N,e[63]=w,e[64]=k):k=e[64];let pe;e[65]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx("label",{className:"text-sm font-medium",children:"Date From"}),e[65]=pe):pe=e[65];let xe;e[66]===Symbol.for("react.memo_cache_sentinel")?(xe=s=>Ge(s.target.value),e[66]=xe):xe=e[66];let R;e[67]!==a?(R=t.jsxs("div",{className:"space-y-2",children:[pe,t.jsx("input",{type:"date",value:a,onChange:xe,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"})]}),e[67]=a,e[68]=R):R=e[68];let he;e[69]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx("label",{className:"text-sm font-medium",children:"Date To"}),e[69]=he):he=e[69];let ge;e[70]===Symbol.for("react.memo_cache_sentinel")?(ge=s=>$e(s.target.value),e[70]=ge):ge=e[70];let C;e[71]!==c?(C=t.jsxs("div",{className:"space-y-2",children:[he,t.jsx("input",{type:"date",value:c,onChange:ge,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"})]}),e[71]=c,e[72]=C):C=e[72];let T;e[73]!==R||e[74]!==C?(T=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[R,C]}),e[73]=R,e[74]=C,e[75]=T):T=e[75];let be;e[76]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsx(Je,{className:"h-4 w-4"}),e[76]=be):be=e[76];let D;e[77]!==Re?(D=t.jsxs("button",{onClick:Re,className:"inline-flex items-center gap-2 justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90",children:[be,"Apply Filters"]}),e[77]=Re,e[78]=D):D=e[78];let _e;e[79]===Symbol.for("react.memo_cache_sentinel")?(_e=t.jsx("button",{onClick:We,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground",children:"Reset"}),e[79]=_e):_e=e[79];let F;e[80]!==D?(F=t.jsxs("div",{className:"flex gap-2 pt-2",children:[D,_e]}),e[80]=D,e[81]=F):F=e[81];let A;e[82]!==k||e[83]!==T||e[84]!==F?(A=t.jsxs("div",{className:"rounded-lg border bg-card",children:[Z,t.jsxs("div",{className:"p-6 space-y-4",children:[k,T,F]})]}),e[82]=k,e[83]=T,e[84]=F,e[85]=A):A=e[85];let E;e[86]!==De?(E=t.jsx("span",{className:"font-semibold text-foreground",children:De}),e[86]=De,e[87]=E):E=e[87];let I;e[88]!==f.length?(I=t.jsx("span",{className:"font-semibold text-foreground",children:f.length}),e[88]=f.length,e[89]=I):I=e[89];let G;e[90]!==E||e[91]!==I?(G=t.jsx("div",{className:"rounded-lg border bg-card p-4",children:t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing"," ",E," ","stores â€¢"," ",I," ","entities"]})}),e[90]=E,e[91]=I,e[92]=G):G=e[92];let je;e[93]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsx("th",{rowSpan:2,className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground sticky left-0 bg-muted/50 z-10",style:{minWidth:120},children:"Store"}),e[93]=je):je=e[93];let $;e[94]!==u?($=u.map(tt),e[94]=u,e[95]=$):$=e[95];let ye,ve;e[96]===Symbol.for("react.memo_cache_sentinel")?(ye=t.jsx("th",{rowSpan:2,className:"text-center align-middle font-bold",children:"Score Without Auto Fail"}),ve=t.jsx("th",{rowSpan:2,className:"text-center align-middle font-bold",children:"Total Score"}),e[96]=ye,e[97]=ve):(ye=e[96],ve=e[97]);let L;e[98]!==$?(L=t.jsxs("tr",{children:[je,$,ye,ve]}),e[98]=$,e[99]=L):L=e[99];let z;e[100]!==u?(z=t.jsx("tr",{children:u.map(Ze)}),e[100]=u,e[101]=z):z=e[101];let H;e[102]!==L||e[103]!==z?(H=t.jsxs("thead",{className:"border-b bg-muted/50",children:[L,z]}),e[102]=L,e[103]=z,e[104]=H):H=e[104];let M;e[105]!==u||e[106]!==g||e[107]!==m||e[108]!==f.length?(M=m.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:f.length+3,className:"h-24 text-center text-muted-foreground",children:"No data found. Try adjusting your filters."})}):m.map(s=>t.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50",children:[t.jsxs("td",{className:"p-4 align-middle sticky left-0 bg-background z-10",children:[t.jsx("div",{className:"font-medium",children:s.store_name}),s.store_group&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:["Group ",s.store_group]})]}),u.map(r=>r.entities.map(O=>{const p=qe(s,O.id);return t.jsx("td",{className:"p-4 align-middle text-center",children:p?t.jsx("div",{className:"text-xs whitespace-pre-line",children:p}):t.jsx("span",{className:"text-muted-foreground",children:"-"})},O.id)})),t.jsx("td",{className:"p-4 align-middle text-center",children:g[s.store_id]?.score_without_auto_fail!==null?g[s.store_id]?.score_without_auto_fail:t.jsx("span",{className:"text-muted-foreground",children:"-"})}),t.jsx("td",{className:"p-4 align-middle text-center",children:typeof g[s.store_id]?.score_with_auto_fail=="number"?g[s.store_id].score_with_auto_fail:t.jsx("span",{className:"text-muted-foreground",children:"-"})})]},s.store_id)),e[105]=u,e[106]=g,e[107]=m,e[108]=f.length,e[109]=M):M=e[109];let U;e[110]!==M?(U=t.jsx("tbody",{children:M}),e[110]=M,e[111]=U):U=e[111];let W;e[112]!==H||e[113]!==U?(W=t.jsx("div",{className:"rounded-lg border bg-card overflow-x-auto",children:t.jsxs("table",{className:"w-full caption-bottom text-sm border-separate border-spacing-0",children:[H,U]})}),e[112]=H,e[113]=U,e[114]=W):W=e[114];let q;e[115]!==b||e[116]!==A||e[117]!==G||e[118]!==W?(q=t.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-4 pt-0",children:[b,A,G,W]}),e[115]=b,e[116]=A,e[117]=G,e[118]=W,e[119]=q):q=e[119];let Ne;return e[120]!==x.user||e[121]!==q?(Ne=t.jsxs(Be,{user:Oe,children:[Q,q]}),e[120]=x.user,e[121]=q,e[122]=Ne):Ne=e[122],Ne}function Ze(l){return l.entities.map(et)}function et(l){return t.jsx("th",{className:"h-12 px-4 text-center align-middle font-medium text-muted-foreground",children:t.jsx("span",{children:l.entity_label})},l.id)}function tt(l){return t.jsx("th",{className:"text-center align-middle font-bold bg-muted/50 text-[15px]",colSpan:l.entities.length,children:l.label},l.label)}function st(l){return t.jsx("option",{value:l.id,children:l.label??`Rating #${l.id}`},l.id)}function lt(l){return t.jsxs("option",{value:l,children:["Group ",l]},l)}function rt(l){return t.jsx("option",{value:l.id,children:l.store},l.id)}function it(l){return l.entities.length>0}function nt(l){return l.count>0}function ot(l,e){const x=l.entities[e];return x?x.rating_counts.filter(ct).map(at).join(", "):""}function at(l){return`${l.count} ${l.rating_label||"No Rating"}`}function ct(l){return l.count>0}export{bt as default};
