import{c as Ae,r as g,j as t,a as U,H as Fe}from"./app-BUKQPHa7.js";import{X as ue,F as De,A as Ie}from"./app-layout-Cqm7Iojn.js";import{C as _e}from"./checkbox-DSoa92N3.js";import{S as pe,P as Ne}from"./save-CBBHpvWa.js";import{F as $e}from"./file-text-ZprA1oVT.js";import{S as Se,T as Ce}from"./trash-2-B3MYouP3.js";import"./app-D3mE4-U5.js";import"./button-eUTeR7b1.js";import"./index-AiCtM_xl.js";import"./index-qi8lqJb0.js";import"./index-TbakzgMN.js";import"./check-BukkaHjE.js";function Ze(i){const e=Ae.c(100),{auth:ge,entities:j,categories:d}=i,[v,he]=g.useState(!1),[x,be]=g.useState(null);let L;e[0]===Symbol.for("react.memo_cache_sentinel")?(L={label:"",sort_order:""},e[0]=L):L=e[0];const[c,O]=g.useState(L);let X;e[1]===Symbol.for("react.memo_cache_sentinel")?(X={label:"",sort_order:""},e[1]=X):X=e[1];const[m,W]=g.useState(X),[_,fe]=g.useState(!1),[u,ye]=g.useState(null);let z;e[2]===Symbol.for("react.memo_cache_sentinel")?(z={entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:"",active:!0},e[2]=z):z=e[2];const[n,h]=g.useState(z);let B;e[3]===Symbol.for("react.memo_cache_sentinel")?(B={entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:"",active:!0},e[3]=B):B=e[3];const[a,p]=g.useState(B);let G;e[4]===Symbol.for("react.memo_cache_sentinel")?(G={},e[4]=G):G=e[4];const[J,o]=g.useState(G);let K;e[5]!==c.label||e[6]!==c.sort_order?(K=r=>{r.preventDefault(),U.post("/categories",{label:c.label,sort_order:c.sort_order||null},{preserveScroll:!0,onSuccess:()=>{O({label:"",sort_order:""}),he(!1),o({})},onError:s=>o(s)})},e[5]=c.label,e[6]=c.sort_order,e[7]=K):K=e[7];const je=K;let Q;e[8]===Symbol.for("react.memo_cache_sentinel")?(Q=r=>{be(r.id),W({label:r.label,sort_order:r.sort_order?.toString()||""}),o({})},e[8]=Q):Q=e[8];const ke=Q;let V;e[9]!==m||e[10]!==x?(V=r=>{r.preventDefault(),x&&U.put(`/categories/${x}`,{label:m.label,sort_order:m.sort_order||null},{preserveScroll:!0,onSuccess:()=>{be(null),W({label:"",sort_order:""}),o({})},onError:s=>o(s)})},e[9]=m,e[10]=x,e[11]=V):V=e[11];const q=V,we=Ue;let N,b,f,y;if(e[12]!==a||e[13]!==u||e[14]!==n){N=l=>{l.preventDefault(),U.post("/entities",{...n,category_id:n.category_id||null,report_type:n.report_type||null,sort_order:n.sort_order||null,active:s(n.active)},{preserveScroll:!0,onSuccess:()=>{h({entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:"",active:!0}),fe(!1),o({})},onError:ve=>o(ve)})};let r;e[19]===Symbol.for("react.memo_cache_sentinel")?(r=l=>{ye(l.id),p({entity_label:l.entity_label,category_id:l.category_id?.toString()||"",date_range_type:l.date_range_type,report_type:l.report_type||"",sort_order:l.sort_order?.toString()||"",active:l.active}),o({})},e[19]=r):r=e[19],f=r,y=l=>{l.preventDefault(),u&&U.put(`/entities/${u}`,{...a,category_id:a.category_id||null,report_type:a.report_type||null,sort_order:a.sort_order||null,active:s(a.active)},{preserveScroll:!0,onSuccess:()=>{ye(null),p({entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:"",active:!0}),o({})},onError:ve=>o(ve)})},b=Pe;const s=Me;e[12]=a,e[13]=u,e[14]=n,e[15]=N,e[16]=b,e[17]=f,e[18]=y}else N=e[15],b=e[16],f=e[17],y=e[18];const Ee=ge.user;let Y;e[20]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx(Fe,{title:"Entities & Categories"}),e[20]=Y):Y=e[20];let Z;e[21]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Entities & Categories"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage inspection entities and their categories"})]}),e[21]=Z):Z=e[21];let ee,te;e[22]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx("div",{className:"rounded-full bg-primary/10 p-3",children:t.jsx(De,{className:"h-5 w-5 text-primary"})}),te=t.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Total Categories"}),e[22]=ee,e[23]=te):(ee=e[22],te=e[23]);let S;e[24]!==d.length?(S=t.jsx("div",{className:"rounded-lg border bg-card p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[ee,t.jsxs("div",{children:[te,t.jsx("p",{className:"text-2xl font-bold",children:d.length})]})]})}),e[24]=d.length,e[25]=S):S=e[25];let re,se;e[26]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx("div",{className:"rounded-full bg-accent/50 p-3",children:t.jsx($e,{className:"h-5 w-5 text-accent-foreground"})}),se=t.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Total Entities"}),e[26]=re,e[27]=se):(re=e[26],se=e[27]);let C;e[28]!==j.length?(C=t.jsx("div",{className:"rounded-lg border bg-card p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[re,t.jsxs("div",{children:[se,t.jsx("p",{className:"text-2xl font-bold",children:j.length})]})]})}),e[28]=j.length,e[29]=C):C=e[29];let k;e[30]!==S||e[31]!==C?(k=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[S,C]}),e[30]=S,e[31]=C,e[32]=k):k=e[32];let le,ae;e[33]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx("h3",{className:"text-lg font-semibold",children:"Categories"}),ae=()=>he(!0),e[33]=le,e[34]=ae):(le=e[33],ae=e[34]);let ne;e[35]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx(Ne,{className:"h-3 w-3"}),e[35]=ne):ne=e[35];let w;e[36]!==v?(w=t.jsxs("div",{className:"bg-muted/50 px-6 py-4 border-b flex items-center justify-between",children:[le,t.jsxs("button",{onClick:ae,disabled:v,className:"inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[ne,"Add"]})]}),e[36]=v,e[37]=w):w=e[37];let ie;e[38]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx("thead",{className:"border-b sticky top-0 bg-background",children:t.jsxs("tr",{children:[t.jsx("th",{className:"h-10 px-4 text-left font-medium text-muted-foreground",children:"Category Name"}),t.jsx("th",{className:"h-10 px-4 text-center font-medium text-muted-foreground",children:"Entities"}),t.jsx("th",{className:"h-10 px-4 text-right font-medium text-muted-foreground",children:"Actions"})]})}),e[38]=ie):ie=e[38];let E;e[39]!==J||e[40]!==je||e[41]!==v||e[42]!==c?(E=v&&t.jsxs("tr",{className:"border-b bg-accent/5",children:[t.jsx("td",{className:"p-3",colSpan:2,children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",placeholder:"Category name",value:c.label,onChange:r=>O({...c,label:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",autoFocus:!0}),t.jsx("input",{type:"number",placeholder:"Sort order (optional)",value:c.sort_order,onChange:r=>O({...c,sort_order:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",min:"0"}),J.label&&t.jsx("p",{className:"text-xs text-destructive mt-1",children:J.label})]})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:je,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground hover:bg-primary/90",children:t.jsx(pe,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>{he(!1),O({label:"",sort_order:""}),o({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border hover:bg-accent",children:t.jsx(ue,{className:"h-3 w-3"})})]})})]}),e[39]=J,e[40]=je,e[41]=v,e[42]=c,e[43]=E):E=e[43];let A;if(e[44]!==d||e[45]!==m||e[46]!==x||e[47]!==q){let r;e[49]!==m||e[50]!==x||e[51]!==q?(r=s=>t.jsx("tr",{className:"border-b hover:bg-muted/50",children:x===s.id?t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"p-3",colSpan:2,children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",value:m.label,onChange:l=>W({...m,label:l.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"}),t.jsx("input",{type:"number",placeholder:"Sort order (optional)",value:m.sort_order,onChange:l=>W({...m,sort_order:l.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",min:"0"})]})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:q,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground",children:t.jsx(pe,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>{be(null),W({label:"",sort_order:""}),o({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border",children:t.jsx(ue,{className:"h-3 w-3"})})]})})]}):t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"p-3 font-medium",children:s.label}),t.jsx("td",{className:"p-3 text-center",children:t.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-muted",children:s.entities_count||0})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:()=>ke(s),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-primary hover:bg-primary/10",children:t.jsx(Se,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>we(s.id,s.label),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-destructive hover:bg-destructive/10",children:t.jsx(Ce,{className:"h-3 w-3"})})]})})]})},s.id),e[49]=m,e[50]=x,e[51]=q,e[52]=r):r=e[52],A=d.map(r),e[44]=d,e[45]=m,e[46]=x,e[47]=q,e[48]=A}else A=e[48];let F;e[53]!==E||e[54]!==A?(F=t.jsx("div",{className:"overflow-auto max-h-[600px]",children:t.jsxs("table",{className:"w-full text-sm",children:[ie,t.jsxs("tbody",{children:[E,A]})]})}),e[53]=E,e[54]=A,e[55]=F):F=e[55];let D;e[56]!==w||e[57]!==F?(D=t.jsxs("div",{className:"rounded-lg border bg-card",children:[w,F]}),e[56]=w,e[57]=F,e[58]=D):D=e[58];let de,oe;e[59]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx("h3",{className:"text-lg font-semibold",children:"Entities"}),oe=()=>fe(!0),e[59]=de,e[60]=oe):(de=e[59],oe=e[60]);let ce;e[61]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(Ne,{className:"h-3 w-3"}),e[61]=ce):ce=e[61];let I;e[62]!==_?(I=t.jsxs("div",{className:"bg-muted/50 px-6 py-4 border-b flex items-center justify-between",children:[de,t.jsxs("button",{onClick:oe,disabled:_,className:"inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[ce,"Add"]})]}),e[62]=_,e[63]=I):I=e[63];let me;e[64]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx("thead",{className:"border-b sticky top-0 bg-background",children:t.jsxs("tr",{children:[t.jsx("th",{className:"h-10 px-4 text-left font-medium text-muted-foreground",children:"Entity Name"}),t.jsx("th",{className:"h-10 px-4 text-left font-medium text-muted-foreground",children:"Category"}),t.jsx("th",{className:"h-10 px-4 text-left font-medium text-muted-foreground",children:"Active"}),t.jsx("th",{className:"h-10 px-4 text-right font-medium text-muted-foreground",children:"Actions"})]})}),e[64]=me):me=e[64];let $;e[65]!==d||e[66]!==N||e[67]!==_||e[68]!==n?($=_&&t.jsx("tr",{className:"border-b bg-accent/5",children:t.jsx("td",{className:"p-3",colSpan:3,children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",placeholder:"Entity name",value:n.entity_label,onChange:r=>h({...n,entity_label:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",autoFocus:!0}),t.jsxs("select",{value:n.category_id,onChange:r=>h({...n,category_id:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Select category"}),d.map(Re)]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("select",{value:n.date_range_type,onChange:r=>h({...n,date_range_type:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"daily",children:"Daily"}),t.jsx("option",{value:"weekly",children:"Weekly"})]}),t.jsxs("select",{value:n.report_type,onChange:r=>h({...n,report_type:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Report type"}),t.jsx("option",{value:"main",children:"Main"}),t.jsx("option",{value:"secondary",children:"Secondary"})]})]}),t.jsx("input",{type:"number",placeholder:"Sort order (optional)",value:n.sort_order,onChange:r=>h({...n,sort_order:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",min:"0"}),t.jsxs("div",{className:"flex items-center justify-between rounded-md border bg-background px-3 py-2",children:[t.jsxs("div",{className:"space-y-0.5",children:[t.jsx("p",{className:"text-sm font-medium leading-none",children:"Active"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable this entity"})]}),t.jsx("input",{type:"hidden",name:"active",value:n.active?"1":"0"}),t.jsx(_e,{checked:n.active,onCheckedChange:r=>{h({...n,active:r===!0})}})]}),t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsxs("button",{onClick:N,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground",children:[t.jsx(pe,{className:"h-3 w-3"})," Save"]}),t.jsxs("button",{onClick:()=>{fe(!1),h({entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:"",active:!0}),o({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border",children:[t.jsx(ue,{className:"h-3 w-3"})," Cancel"]})]})]})})}),e[65]=d,e[66]=N,e[67]=_,e[68]=n,e[69]=$):$=e[69];let T;if(e[70]!==d||e[71]!==a||e[72]!==u||e[73]!==j||e[74]!==b||e[75]!==f||e[76]!==y){let r;e[78]!==d||e[79]!==a||e[80]!==u||e[81]!==b||e[82]!==f||e[83]!==y?(r=s=>t.jsx("tr",{className:"border-b hover:bg-muted/50",children:u===s.id?t.jsx("td",{className:"p-3",colSpan:3,children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",value:a.entity_label,onChange:l=>p({...a,entity_label:l.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm"}),t.jsxs("select",{value:a.category_id,onChange:l=>p({...a,category_id:l.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Select category"}),d.map(Te)]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("select",{value:a.date_range_type,onChange:l=>p({...a,date_range_type:l.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"daily",children:"Daily"}),t.jsx("option",{value:"weekly",children:"Weekly"})]}),t.jsxs("select",{value:a.report_type,onChange:l=>p({...a,report_type:l.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Report type"}),t.jsx("option",{value:"main",children:"Main"}),t.jsx("option",{value:"secondary",children:"Secondary"})]})]}),t.jsx("input",{type:"number",placeholder:"Sort order (optional)",value:a.sort_order,onChange:l=>p({...a,sort_order:l.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",min:"0"}),t.jsxs("div",{className:"flex items-center justify-between rounded-md border bg-background px-3 py-2",children:[t.jsxs("div",{className:"space-y-0.5",children:[t.jsx("p",{className:"text-sm font-medium leading-none",children:"Active"}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable this entity"})]}),t.jsx("input",{type:"hidden",name:"active",value:a.active?"1":"0"}),t.jsx(_e,{checked:a.active,onCheckedChange:l=>{p({...a,active:l===!0})}})]}),t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:y,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground",children:t.jsx(pe,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>{ye(null),p({entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:"",active:!0}),o({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border",children:t.jsx(ue,{className:"h-3 w-3"})})]})]})}):t.jsxs(t.Fragment,{children:[t.jsxs("td",{className:"p-3 font-medium",children:[s.entity_label,t.jsxs("div",{className:"flex gap-1 mt-1",children:[t.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-muted",children:s.date_range_type}),s.report_type&&t.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-accent/30",children:s.report_type})]})]}),t.jsx("td",{className:"p-3",children:s.category?t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-primary/10 text-primary",children:s.category.label}):t.jsx("span",{className:"text-xs text-muted-foreground",children:"No category"})}),t.jsx("td",{className:"p-3",children:s.active?t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-green-100 text-green-800",children:"Active"}):t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-red-100 text-red-800",children:"Inactive"})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:()=>f(s),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-primary hover:bg-primary/10",children:t.jsx(Se,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>b(s.id,s.entity_label),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-destructive hover:bg-destructive/10",children:t.jsx(Ce,{className:"h-3 w-3"})})]})})]})},s.id),e[78]=d,e[79]=a,e[80]=u,e[81]=b,e[82]=f,e[83]=y,e[84]=r):r=e[84],T=j.map(r),e[70]=d,e[71]=a,e[72]=u,e[73]=j,e[74]=b,e[75]=f,e[76]=y,e[77]=T}else T=e[77];let R;e[85]!==$||e[86]!==T?(R=t.jsx("div",{className:"overflow-auto max-h-[600px]",children:t.jsxs("table",{className:"w-full text-sm",children:[me,t.jsxs("tbody",{children:[$,T]})]})}),e[85]=$,e[86]=T,e[87]=R):R=e[87];let M;e[88]!==I||e[89]!==R?(M=t.jsxs("div",{className:"rounded-lg border bg-card",children:[I,R]}),e[88]=I,e[89]=R,e[90]=M):M=e[90];let P;e[91]!==D||e[92]!==M?(P=t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[D,M]}),e[91]=D,e[92]=M,e[93]=P):P=e[93];let H;e[94]!==k||e[95]!==P?(H=t.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-4 pt-0",children:[Z,k,P]}),e[94]=k,e[95]=P,e[96]=H):H=e[96];let xe;return e[97]!==ge.user||e[98]!==H?(xe=t.jsxs(Ie,{user:Ee,children:[Y,H]}),e[97]=ge.user,e[98]=H,e[99]=xe):xe=e[99],xe}function Te(i){return t.jsx("option",{value:i.id,children:i.label},i.id)}function Re(i){return t.jsx("option",{value:i.id,children:i.label},i.id)}function Me(i){return i?1:0}function Pe(i,e){confirm(`Delete entity "${e}"?`)&&U.delete(`/entities/${i}`,{preserveScroll:!0,onError:He})}function He(i){return alert(i.error||"Failed to delete")}function Ue(i,e){confirm(`Delete category "${e}"?`)&&U.delete(`/categories/${i}`,{preserveScroll:!0,onError:We})}function We(i){return alert(i.error||"Failed to delete")}export{Ze as default};
