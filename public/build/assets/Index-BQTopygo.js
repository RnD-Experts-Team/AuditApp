import{c as Ie,r as ie,j as t,a as De,H as We}from"./app-BQRJ0j_D.js";import{A as ze}from"./app-layout-DmC8kEH5.js";import{c as Fe}from"./button-CiWo4oFx.js";import{R as He}from"./refresh-cw-BM-I88f4.js";import"./app-CGKmwihm.js";import"./index-eVsFUjm_.js";import"./index-Bn9IGVAo.js";import"./index-AaGKiXUI.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Ue=Fe("Download",Le);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Oe=Fe("Filter",Me);function ct(s){const e=Ie.c(123),{auth:N,reportData:S,stores:te,groups:se,filters:le}=s,[o,ke]=ie.useState(le.report_type||""),[r,$e]=ie.useState(le.store_id||""),[n,Ce]=ie.useState(le.group||""),[i,Te]=ie.useState(le.date_from||""),[a,Ae]=ie.useState(le.date_to||"");let ae;e[0]!==i||e[1]!==a||e[2]!==n||e[3]!==o||e[4]!==r?(ae=()=>{De.get("/camera-reports",{report_type:o,store_id:r,group:n,date_from:i,date_to:a},{preserveState:!0,preserveScroll:!0})},e[0]=i,e[1]=a,e[2]=n,e[3]=o,e[4]=r,e[5]=ae):ae=e[5];const oe=ae;let ce;e[6]===Symbol.for("react.memo_cache_sentinel")?(ce=()=>{ke(""),$e(""),Ce(""),Te(""),Ae(""),De.get("/camera-reports")},e[6]=ce):ce=e[6];const Ee=ce;let de;e[7]!==i||e[8]!==a||e[9]!==n||e[10]!==S||e[11]!==o||e[12]!==r?(de=()=>{const{summary:W,entities:z}=S;let d="data:text/csv;charset=utf-8,";const H="Store,Group,"+z.map(et).join(",")+",Score Without Auto Fail,Total Score";d=d+(encodeURIComponent(H)+"%0A"),W.forEach(f=>{let c=`"${f.store_name}",${f.store_group||""}`;z.forEach(O=>{const y=f.entities[O.id];if(y){const _=y.rating_counts.filter(Ze).map(Ye).join("; ");c=c+`,"${_||"-"}"`}else c=c+",-"});const b=S.scoreData[f.store_id]?.score_without_auto_fail??"-",M=S.scoreData[f.store_id]?.score_with_auto_fail??"-";c=c+`,${b},${M}`,d=d+(encodeURIComponent(c)+"%0A")});const m=document.createElement("a");m.setAttribute("href",d);const L=new Date().toISOString().split("T")[0],u=[];o&&u.push(`Type-${o}`),r&&u.push(`Store-${r}`),n&&u.push(`Group-${n}`),i&&a&&u.push(`${i}_to_${a}`);const U=`camera-report-${u.join("_")}_${L}.csv`;m.setAttribute("download",U),document.body.appendChild(m),m.click(),document.body.removeChild(m)},e[7]=i,e[8]=a,e[9]=n,e[10]=S,e[11]=o,e[12]=r,e[13]=de):de=e[13];const re=de,Ge=Ke,{summary:me,entities:j,total_stores:ne,scoreData:w}=S;let k,p,x,$,h,C,T,A,R,D,g;if(e[14]!==oe||e[15]!==N.user||e[16]!==i||e[17]!==a||e[18]!==j||e[19]!==re||e[20]!==n||e[21]!==se||e[22]!==o||e[23]!==w||e[24]!==r||e[25]!==te||e[26]!==me||e[27]!==ne){const W={};j.forEach(l=>{const we=l.category?.id??0,v=l.category?.label??"Uncategorized";W[v]||(W[v]={id:we,label:v,entities:[]}),W[v].entities.push(l)});const z=Object.values(W);k=ze,$=N.user,e[39]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx(We,{title:"Camera Reports"}),e[39]=h):h=e[39],D="flex flex-1 flex-col gap-6 p-4 pt-0";let d;e[40]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Camera Reports"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Summary of ratings per store and entity"})]}),e[40]=d):d=e[40];let H;e[41]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx(Ue,{className:"h-4 w-4"}),e[41]=H):H=e[41],e[42]!==re?(g=t.jsxs("div",{className:"flex items-center justify-between",children:[d,t.jsxs("button",{onClick:re,className:"inline-flex items-center gap-2 justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 transition-colors",children:[H,"Export"]})]}),e[42]=re,e[43]=g):g=e[43];let m;e[44]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-accent/10 px-6 py-4 border-b",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Oe,{className:"h-5 w-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"Filters"})]})}),e[44]=m):m=e[44];let L;e[45]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx("label",{className:"text-sm font-medium",children:"Report Type"}),e[45]=L):L=e[45];let u;e[46]===Symbol.for("react.memo_cache_sentinel")?(u=l=>ke(l.target.value),e[46]=u):u=e[46];let U,f,c;e[47]===Symbol.for("react.memo_cache_sentinel")?(U=t.jsx("option",{value:"",children:"All Types"}),f=t.jsx("option",{value:"main",children:"Main"}),c=t.jsx("option",{value:"secondary",children:"Secondary"}),e[47]=U,e[48]=f,e[49]=c):(U=e[47],f=e[48],c=e[49]);let b;e[50]!==o?(b=t.jsxs("div",{className:"space-y-2",children:[L,t.jsxs("select",{value:o,onChange:u,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[U,f,c]})]}),e[50]=o,e[51]=b):b=e[51];let M;e[52]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx("label",{className:"text-sm font-medium",children:"Store"}),e[52]=M):M=e[52];let O;e[53]===Symbol.for("react.memo_cache_sentinel")?(O=l=>$e(l.target.value),e[53]=O):O=e[53];let y;e[54]===Symbol.for("react.memo_cache_sentinel")?(y=t.jsx("option",{value:"",children:"All Stores"}),e[54]=y):y=e[54];let _;e[55]!==te?(_=te.map(Je),e[55]=te,e[56]=_):_=e[56];let q;e[57]!==r||e[58]!==_?(q=t.jsxs("div",{className:"space-y-2",children:[M,t.jsxs("select",{value:r,onChange:O,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[y,_]})]}),e[57]=r,e[58]=_,e[59]=q):q=e[59];let fe;e[60]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx("label",{className:"text-sm font-medium",children:"Group"}),e[60]=fe):fe=e[60];let pe;e[61]===Symbol.for("react.memo_cache_sentinel")?(pe=l=>Ce(l.target.value),e[61]=pe):pe=e[61];let xe;e[62]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsx("option",{value:"",children:"All Groups"}),e[62]=xe):xe=e[62];let P;e[63]!==se?(P=se.map(Be),e[63]=se,e[64]=P):P=e[64];let V;e[65]!==n||e[66]!==P?(V=t.jsxs("div",{className:"space-y-2",children:[fe,t.jsxs("select",{value:n,onChange:pe,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[xe,P]})]}),e[65]=n,e[66]=P,e[67]=V):V=e[67];let B;e[68]!==b||e[69]!==q||e[70]!==V?(B=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[b,q,V]}),e[68]=b,e[69]=q,e[70]=V,e[71]=B):B=e[71];let he;e[72]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx("label",{className:"text-sm font-medium",children:"Date From"}),e[72]=he):he=e[72];let ge;e[73]===Symbol.for("react.memo_cache_sentinel")?(ge=l=>Te(l.target.value),e[73]=ge):ge=e[73];let J;e[74]!==i?(J=t.jsxs("div",{className:"space-y-2",children:[he,t.jsx("input",{type:"date",value:i,onChange:ge,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"})]}),e[74]=i,e[75]=J):J=e[75];let be;e[76]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsx("label",{className:"text-sm font-medium",children:"Date To"}),e[76]=be):be=e[76];let _e;e[77]===Symbol.for("react.memo_cache_sentinel")?(_e=l=>Ae(l.target.value),e[77]=_e):_e=e[77];let K;e[78]!==a?(K=t.jsxs("div",{className:"space-y-2",children:[be,t.jsx("input",{type:"date",value:a,onChange:_e,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"})]}),e[78]=a,e[79]=K):K=e[79];let Q;e[80]!==J||e[81]!==K?(Q=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[J,K]}),e[80]=J,e[81]=K,e[82]=Q):Q=e[82];let je;e[83]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsx(He,{className:"h-4 w-4"}),e[83]=je):je=e[83];let X;e[84]!==oe?(X=t.jsxs("button",{onClick:oe,className:"inline-flex items-center gap-2 justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90",children:[je,"Apply Filters"]}),e[84]=oe,e[85]=X):X=e[85];let ye;e[86]===Symbol.for("react.memo_cache_sentinel")?(ye=t.jsx("button",{onClick:Ee,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground",children:"Reset"}),e[86]=ye):ye=e[86];let Y;e[87]!==X?(Y=t.jsxs("div",{className:"flex gap-2 pt-2",children:[X,ye]}),e[87]=X,e[88]=Y):Y=e[88],e[89]!==B||e[90]!==Q||e[91]!==Y?(p=t.jsxs("div",{className:"rounded-lg border bg-card",children:[m,t.jsxs("div",{className:"p-6 space-y-4",children:[B,Q,Y]})]}),e[89]=B,e[90]=Q,e[91]=Y,e[92]=p):p=e[92];let Z;e[93]!==ne?(Z=t.jsx("span",{className:"font-semibold text-foreground",children:ne}),e[93]=ne,e[94]=Z):Z=e[94];let ee;e[95]!==j.length?(ee=t.jsx("span",{className:"font-semibold text-foreground",children:j.length}),e[95]=j.length,e[96]=ee):ee=e[96],e[97]!==Z||e[98]!==ee?(x=t.jsx("div",{className:"rounded-lg border bg-card p-4",children:t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing"," ",Z," ","stores â€¢"," ",ee," ","entities"]})}),e[97]=Z,e[98]=ee,e[99]=x):x=e[99],R="rounded-lg border bg-card overflow-x-auto",T="w-full caption-bottom text-sm border-separate border-spacing-0";let ve;e[100]===Symbol.for("react.memo_cache_sentinel")?(ve=t.jsx("th",{rowSpan:2,className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground sticky left-0 bg-muted/50 z-10",style:{minWidth:120},children:"Store"}),e[100]=ve):ve=e[100];let Ne,Se;e[101]===Symbol.for("react.memo_cache_sentinel")?(Ne=t.jsx("th",{rowSpan:2,className:"text-center align-middle font-bold",children:"Score Without Auto Fail"}),Se=t.jsx("th",{rowSpan:2,className:"text-center align-middle font-bold",children:"Total Score"}),e[101]=Ne,e[102]=Se):(Ne=e[101],Se=e[102]),A=t.jsxs("thead",{className:"border-b bg-muted/50",children:[t.jsxs("tr",{children:[ve,z.map(Ve),Ne,Se]}),t.jsx("tr",{children:z.map(qe)})]}),C=me.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:j.length+3,className:"h-24 text-center text-muted-foreground",children:"No data found. Try adjusting your filters."})}):me.map(l=>t.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50",children:[t.jsxs("td",{className:"p-4 align-middle sticky left-0 bg-background z-10",children:[t.jsx("div",{className:"font-medium",children:l.store_name}),l.store_group&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:["Group ",l.store_group]})]}),z.map(we=>we.entities.map(v=>{const Re=Ge(l,v.id);return t.jsx("td",{className:"p-4 align-middle text-center",children:Re?t.jsx("div",{className:"text-xs whitespace-pre-line",children:Re}):t.jsx("span",{className:"text-muted-foreground",children:"-"})},v.id)})),t.jsx("td",{className:"p-4 align-middle text-center",children:w[l.store_id]?.score_without_auto_fail!==null?w[l.store_id]?.score_without_auto_fail:t.jsx("span",{className:"text-muted-foreground",children:"-"})}),t.jsx("td",{className:"p-4 align-middle text-center",children:typeof w[l.store_id]?.score_with_auto_fail=="number"?w[l.store_id].score_with_auto_fail:t.jsx("span",{className:"text-muted-foreground",children:"-"})})]},l.store_id)),e[14]=oe,e[15]=N.user,e[16]=i,e[17]=a,e[18]=j,e[19]=re,e[20]=n,e[21]=se,e[22]=o,e[23]=w,e[24]=r,e[25]=te,e[26]=me,e[27]=ne,e[28]=k,e[29]=p,e[30]=x,e[31]=$,e[32]=h,e[33]=C,e[34]=T,e[35]=A,e[36]=R,e[37]=D,e[38]=g}else k=e[28],p=e[29],x=e[30],$=e[31],h=e[32],C=e[33],T=e[34],A=e[35],R=e[36],D=e[37],g=e[38];let F;e[103]!==C?(F=t.jsx("tbody",{children:C}),e[103]=C,e[104]=F):F=e[104];let E;e[105]!==F||e[106]!==T||e[107]!==A?(E=t.jsxs("table",{className:T,children:[A,F]}),e[105]=F,e[106]=T,e[107]=A,e[108]=E):E=e[108];let G;e[109]!==E||e[110]!==R?(G=t.jsx("div",{className:R,children:E}),e[109]=E,e[110]=R,e[111]=G):G=e[111];let I;e[112]!==p||e[113]!==x||e[114]!==G||e[115]!==D||e[116]!==g?(I=t.jsxs("div",{className:D,children:[g,p,x,G]}),e[112]=p,e[113]=x,e[114]=G,e[115]=D,e[116]=g,e[117]=I):I=e[117];let ue;return e[118]!==k||e[119]!==$||e[120]!==h||e[121]!==I?(ue=t.jsxs(k,{user:$,children:[h,I]}),e[118]=k,e[119]=$,e[120]=h,e[121]=I,e[122]=ue):ue=e[122],ue}function qe(s){return s.entities.map(Pe)}function Pe(s){return t.jsx("th",{className:"h-12 px-4 text-center align-middle font-medium text-muted-foreground",children:t.jsx("span",{children:s.entity_label})},s.id)}function Ve(s){return t.jsx("th",{className:"text-center align-middle font-bold bg-muted/50 text-[15px]",colSpan:s.entities.length,children:s.label},s.label)}function Be(s){return t.jsxs("option",{value:s,children:["Group ",s]},s)}function Je(s){return t.jsx("option",{value:s.id,children:s.store},s.id)}function Ke(s,e){const N=s.entities[e];return N?N.rating_counts.filter(Xe).map(Qe).join(", "):""}function Qe(s){return`${s.count} ${s.rating_label||"No Rating"}`}function Xe(s){return s.count>0}function Ye(s){return`${s.count} ${s.rating_label||"No Rating"}`}function Ze(s){return s.count>0}function et(s){return s.entity_label}export{ct as default};
