import{c as B,r as A,j as t,a as $,H as J,L as P}from"./app-BPiuJiXE.js";import{A as Q}from"./app-layout-msTm_QoI.js";import"./app-mtoV7vCQ.js";import"./button-Ro51u8WX.js";import"./index-DYiqaCsJ.js";import"./index-Cv2by6ib.js";function re(s){const e=B.c(32),{auth:C,users:a,groups:m,flash:d}=s,[o,I]=A.useState(null),[l,U]=A.useState("User");let b;e[0]===Symbol.for("react.memo_cache_sentinel")?(b=[],e[0]=b):b=e[0];const[c,E]=A.useState(b),[g,G]=A.useState(!1),F=V,H=O;let j;e[1]===Symbol.for("react.memo_cache_sentinel")?(j=r=>{I(r.id),U(r.role);const i=(r.userGroups??[]).map(K);E(i)},e[1]=j):j=e[1];const M=j;let N;e[2]===Symbol.for("react.memo_cache_sentinel")?(N=()=>{I(null),U("User"),E([]),G(!1)},e[2]=N):N=e[2];const R=N;let y;e[3]===Symbol.for("react.memo_cache_sentinel")?(y=r=>{E(i=>i.includes(r)?i.filter(n=>n!==r):[...i,r])},e[3]=y):y=e[3];const L=y;let _;e:{if(!o){_=!1;break e}_=!0}const u=_;let v;e[4]!==u||e[5]!==o||e[6]!==l||e[7]!==c?(v=()=>{!o||!u||(G(!0),$.put(`/users/${o}`,{role:l,groups:l==="User"?c:[]},{preserveScroll:!0,onFinish:()=>G(!1),onSuccess:()=>R()}))},e[4]=u,e[5]=o,e[6]=l,e[7]=c,e[8]=v):v=e[8];const D=v;let w;e[9]===Symbol.for("react.memo_cache_sentinel")?(w=t.jsx(J,{title:"Users"}),e[9]=w):w=e[9];let S;e[10]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Users Management"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Read-only user list. You can only manage role and group access."})]}),t.jsx(P,{href:"#",onClick:z,className:"inline-flex items-center justify-center rounded-md bg-primary/40 px-4 py-2 text-sm font-medium text-primary-foreground shadow cursor-not-allowed",title:"User creation is disabled in QA system",children:"+ Create User (Disabled)"})]}),e[10]=S):S=e[10];let x;e[11]!==d?(x=d?.success&&t.jsx("div",{className:"mb-2 p-4 bg-green-100 border border-green-400 text-green-700 rounded",children:d.success}),e[11]=d,e[12]=x):x=e[12];let p;e[13]!==d?(p=d?.error&&t.jsx("div",{className:"mb-2 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:d.error}),e[13]=d,e[14]=p):p=e[14];let h;e[15]!==u||e[16]!==o||e[17]!==m||e[18]!==l||e[19]!==D||e[20]!==g||e[21]!==c||e[22]!==a.data||e[23]!==a.links?(h=t.jsx("div",{className:"rounded-lg border bg-card",children:a.data.length>0?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"relative w-full overflow-auto",children:t.jsxs("table",{className:"w-full caption-bottom text-sm",children:[t.jsx("thead",{className:"border-b",children:t.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50",children:[t.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground whitespace-nowrap",children:"ID"}),t.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground whitespace-nowrap",children:"Name"}),t.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground whitespace-nowrap",children:"Email"}),t.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground whitespace-nowrap",children:"Role"}),t.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground whitespace-nowrap",children:"Groups"}),t.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground whitespace-nowrap",children:"Joined"}),t.jsx("th",{className:"h-12 px-4 text-center align-middle font-medium text-muted-foreground whitespace-nowrap",children:"Actions"})]})}),t.jsx("tbody",{children:a.data.map(r=>{const i=o===r.id;return(r.userGroups??[]).map(q).filter(Y),t.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50",children:[t.jsx("td",{className:"p-4 align-middle font-medium whitespace-nowrap",children:r.id}),t.jsx("td",{className:"p-4 align-middle whitespace-nowrap",children:r.name}),t.jsx("td",{className:"p-4 align-middle text-muted-foreground whitespace-nowrap",children:r.email}),t.jsx("td",{className:"p-4 align-middle whitespace-nowrap",children:i?t.jsxs("select",{value:l,onChange:n=>U(n.target.value),className:"flex h-9 w-32 rounded-md border border-input bg-background px-3 py-1 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[t.jsx("option",{value:"User",children:"User"}),t.jsx("option",{value:"Admin",children:"Admin"})]}):t.jsx("span",{className:`inline-flex items-center justify-center px-3 py-1 text-xs font-medium rounded-md ${H(r.role)}`,children:r.role})}),t.jsx("td",{className:"p-4 align-middle",children:i?t.jsx("div",{className:"min-w-[280px]",children:l==="Admin"?t.jsx("span",{className:"text-xs text-muted-foreground",children:"Admin has access to all groups."}):m.length>0?t.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(n=>t.jsxs("label",{className:"inline-flex items-center gap-2 rounded-md border px-2 py-1 text-xs cursor-pointer hover:bg-accent",children:[t.jsx("input",{type:"checkbox",checked:c.includes(n),onChange:()=>L(n),className:"rounded border-gray-300"}),"Group ",n]},n))}):t.jsx("span",{className:"text-xs text-muted-foreground",children:"No groups available yet."})}):t.jsx("div",{className:"flex flex-wrap gap-2",children:l==="Admin"?t.jsx("span",{className:"text-xs text-muted-foreground",children:"Admin has access to all groups."}):m.length>0?t.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(n=>t.jsxs("label",{className:"inline-flex items-center gap-2 rounded-md border px-2 py-1 text-xs cursor-pointer hover:bg-accent",children:[t.jsx("input",{type:"checkbox",checked:c.includes(n),onChange:()=>L(n),className:"rounded border-gray-300"}),"Group ",n]},n))}):t.jsx("span",{className:"text-xs text-muted-foreground",children:"No groups available yet."})})}),t.jsx("td",{className:"p-4 align-middle text-muted-foreground whitespace-nowrap",children:F(r.created_at)}),t.jsx("td",{className:"p-4 align-middle whitespace-nowrap",children:t.jsx("div",{className:"flex gap-2 justify-center",children:i?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:D,disabled:g||!u,className:"inline-flex items-center justify-center rounded-md bg-primary px-3 py-1.5 text-xs font-medium text-primary-foreground shadow hover:bg-primary/90 disabled:opacity-50",children:g?"Saving...":"Save"}),t.jsx("button",{onClick:R,disabled:g,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-3 py-1.5 text-xs font-medium hover:bg-accent hover:text-accent-foreground disabled:opacity-50",children:"Cancel"})]}):t.jsx("button",{onClick:()=>M(r),className:"text-sm font-medium text-primary hover:underline",children:"Edit Permissions"})})})]},r.id)})})]})}),a.links&&a.links.length>3&&t.jsx("div",{className:"flex items-center justify-center gap-2 p-4 border-t",children:a.links.map(T)})]}):t.jsx("div",{className:"h-24 text-center text-muted-foreground flex items-center justify-center",children:"No users found."})}),e[15]=u,e[16]=o,e[17]=m,e[18]=l,e[19]=D,e[20]=g,e[21]=c,e[22]=a.data,e[23]=a.links,e[24]=h):h=e[24];let f;e[25]!==p||e[26]!==h||e[27]!==x?(f=t.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 pt-0",children:[S,x,p,h]}),e[25]=p,e[26]=h,e[27]=x,e[28]=f):f=e[28];let k;return e[29]!==C.user||e[30]!==f?(k=t.jsxs(Q,{user:C.user,children:[w,f]}),e[29]=C.user,e[30]=f,e[31]=k):k=e[31],k}function T(s,e){return t.jsx("button",{onClick:()=>s.url&&$.visit(s.url),disabled:!s.url,className:`inline-flex items-center justify-center rounded-md px-3 py-1 text-sm font-medium transition-colors ${s.active?"bg-primary text-primary-foreground":"hover:bg-accent hover:text-accent-foreground"} ${s.url?"":"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},e)}function Y(s){return Number.isInteger(s)}function q(s){return s.group}function z(s){return s.preventDefault()}function K(s){return s.group}function O(s){return s==="Admin"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}function V(s){return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}export{re as default};
