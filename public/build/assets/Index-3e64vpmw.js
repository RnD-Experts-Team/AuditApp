import{c as We,r as q,j as t,a as $e,H as qe}from"./app-0-cEbQZf.js";import{A as Oe}from"./app-layout-B-Zvyamh.js";import{c as Le}from"./button-ozQ66l2n.js";import{R as Pe}from"./refresh-cw-UpzgpWFk.js";import"./app-oXLXr3Y0.js";import"./index-CNGqGlaO.js";import"./index-C2h5YoHJ.js";import"./index-AaGKiXUI.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Be=Le("Download",Ve);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Ke=Le("Filter",Je);function ut(l){const e=We.c(117),{auth:p,reportData:ze,stores:Se,groups:we,ratings:ke,filters:x}=l,[r,Fe]=q.useState(x.report_type||""),[i,De]=q.useState(x.store_id||""),[n,Ae]=q.useState(x.group||""),[o,Ie]=q.useState(x.date_from||""),[a,Ee]=q.useState(x.date_to||""),[c,Ge]=q.useState(x.rating_id||"");let O;e[0]!==o||e[1]!==a||e[2]!==n||e[3]!==c||e[4]!==r||e[5]!==i?(O=()=>{$e.get("/camera-reports",{report_type:r,store_id:i,group:n,date_from:o,date_to:a,rating_id:c},{preserveState:!0,preserveScroll:!0})},e[0]=o,e[1]=a,e[2]=n,e[3]=c,e[4]=r,e[5]=i,e[6]=O):O=e[6];const Re=O;let P;e[7]===Symbol.for("react.memo_cache_sentinel")?(P=()=>{Fe(""),De(""),Ae(""),Ie(""),Ee(""),Ge(""),$e.get("/camera-reports")},e[7]=P):P=e[7];const He=P;let V;e[8]!==o||e[9]!==a||e[10]!==n||e[11]!==c||e[12]!==r||e[13]!==i?(V=()=>{const s=new URLSearchParams;r&&s.set("report_type",r),i&&s.set("store_id",String(i)),n&&s.set("group",String(n)),o&&s.set("date_from",o),a&&s.set("date_to",a),c&&s.set("rating_id",String(c));const f=`/camera-reports/export?${s.toString()}`;window.location.href=f},e[8]=o,e[9]=a,e[10]=n,e[11]=c,e[12]=r,e[13]=i,e[14]=V):V=e[14];const Ce=V,Me=st,{summary:B,entities:d,total_stores:Te,scoreData:h}=ze;let J;if(e[15]!==d){const s={};d.forEach(f=>{const Ne=f.category?.id??0,u=f.category?.label??"Uncategorized";s[u]||(s[u]={id:Ne,label:u,entities:[]}),s[u].entities.push(f)}),J=Object.values(s),e[15]=d,e[16]=J}else J=e[16];const m=J,Ue=p.user;let K;e[17]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsx(qe,{title:"Camera Reports"}),e[17]=K):K=e[17];let Q;e[18]===Symbol.for("react.memo_cache_sentinel")?(Q=t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Camera Reports"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Summary of ratings per store and entity"})]}),e[18]=Q):Q=e[18];let X;e[19]===Symbol.for("react.memo_cache_sentinel")?(X=t.jsx(Be,{className:"h-4 w-4"}),e[19]=X):X=e[19];let g;e[20]!==Ce?(g=t.jsxs("div",{className:"flex items-center justify-between",children:[Q,t.jsxs("button",{onClick:Ce,className:"inline-flex items-center gap-2 justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 transition-colors",children:[X,"Export"]})]}),e[20]=Ce,e[21]=g):g=e[21];let Y;e[22]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-accent/10 px-6 py-4 border-b",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ke,{className:"h-5 w-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"Filters"})]})}),e[22]=Y):Y=e[22];let Z;e[23]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsx("label",{className:"text-sm font-medium",children:"Report Type"}),e[23]=Z):Z=e[23];let ee;e[24]===Symbol.for("react.memo_cache_sentinel")?(ee=s=>Fe(s.target.value),e[24]=ee):ee=e[24];let te,se,le;e[25]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx("option",{value:"",children:"All Types"}),se=t.jsx("option",{value:"main",children:"Main"}),le=t.jsx("option",{value:"secondary",children:"Secondary"}),e[25]=te,e[26]=se,e[27]=le):(te=e[25],se=e[26],le=e[27]);let b;e[28]!==r?(b=t.jsxs("div",{className:"space-y-2",children:[Z,t.jsxs("select",{value:r,onChange:ee,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[te,se,le]})]}),e[28]=r,e[29]=b):b=e[29];let re;e[30]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx("label",{className:"text-sm font-medium",children:"Store"}),e[30]=re):re=e[30];let ie;e[31]===Symbol.for("react.memo_cache_sentinel")?(ie=s=>De(s.target.value),e[31]=ie):ie=e[31];let ne;e[32]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx("option",{value:"",children:"All Stores"}),e[32]=ne):ne=e[32];let _;e[33]!==Se?(_=Se.map(tt),e[33]=Se,e[34]=_):_=e[34];let j;e[35]!==i||e[36]!==_?(j=t.jsxs("div",{className:"space-y-2",children:[re,t.jsxs("select",{value:i,onChange:ie,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[ne,_]})]}),e[35]=i,e[36]=_,e[37]=j):j=e[37];let oe;e[38]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx("label",{className:"text-sm font-medium",children:"Group"}),e[38]=oe):oe=e[38];let ae;e[39]===Symbol.for("react.memo_cache_sentinel")?(ae=s=>Ae(s.target.value),e[39]=ae):ae=e[39];let ce;e[40]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx("option",{value:"",children:"All Groups"}),e[40]=ce):ce=e[40];let y;e[41]!==we?(y=we.map(et),e[41]=we,e[42]=y):y=e[42];let v;e[43]!==n||e[44]!==y?(v=t.jsxs("div",{className:"space-y-2",children:[oe,t.jsxs("select",{value:n,onChange:ae,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[ce,y]})]}),e[43]=n,e[44]=y,e[45]=v):v=e[45];let de;e[46]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx("label",{className:"text-sm font-medium",children:"Rating"}),e[46]=de):de=e[46];let me;e[47]===Symbol.for("react.memo_cache_sentinel")?(me=s=>Ge(s.target.value),e[47]=me):me=e[47];let fe;e[48]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx("option",{value:"",children:"All Ratings"}),e[48]=fe):fe=e[48];let N;e[49]!==ke?(N=ke.map(Ze),e[49]=ke,e[50]=N):N=e[50];let S;e[51]!==c||e[52]!==N?(S=t.jsxs("div",{className:"space-y-2",children:[de,t.jsxs("select",{value:c,onChange:me,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[fe,N]})]}),e[51]=c,e[52]=N,e[53]=S):S=e[53];let w;e[54]!==b||e[55]!==j||e[56]!==v||e[57]!==S?(w=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[b,j,v,S]}),e[54]=b,e[55]=j,e[56]=v,e[57]=S,e[58]=w):w=e[58];let ue;e[59]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx("label",{className:"text-sm font-medium",children:"Date From"}),e[59]=ue):ue=e[59];let pe;e[60]===Symbol.for("react.memo_cache_sentinel")?(pe=s=>Ie(s.target.value),e[60]=pe):pe=e[60];let k;e[61]!==o?(k=t.jsxs("div",{className:"space-y-2",children:[ue,t.jsx("input",{type:"date",value:o,onChange:pe,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"})]}),e[61]=o,e[62]=k):k=e[62];let xe;e[63]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsx("label",{className:"text-sm font-medium",children:"Date To"}),e[63]=xe):xe=e[63];let he;e[64]===Symbol.for("react.memo_cache_sentinel")?(he=s=>Ee(s.target.value),e[64]=he):he=e[64];let R;e[65]!==a?(R=t.jsxs("div",{className:"space-y-2",children:[xe,t.jsx("input",{type:"date",value:a,onChange:he,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"})]}),e[65]=a,e[66]=R):R=e[66];let C;e[67]!==k||e[68]!==R?(C=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[k,R]}),e[67]=k,e[68]=R,e[69]=C):C=e[69];let ge;e[70]===Symbol.for("react.memo_cache_sentinel")?(ge=t.jsx(Pe,{className:"h-4 w-4"}),e[70]=ge):ge=e[70];let T;e[71]!==Re?(T=t.jsxs("button",{onClick:Re,className:"inline-flex items-center gap-2 justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90",children:[ge,"Apply Filters"]}),e[71]=Re,e[72]=T):T=e[72];let be;e[73]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsx("button",{onClick:He,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground",children:"Reset"}),e[73]=be):be=e[73];let F;e[74]!==T?(F=t.jsxs("div",{className:"flex gap-2 pt-2",children:[T,be]}),e[74]=T,e[75]=F):F=e[75];let D;e[76]!==w||e[77]!==C||e[78]!==F?(D=t.jsxs("div",{className:"rounded-lg border bg-card",children:[Y,t.jsxs("div",{className:"p-6 space-y-4",children:[w,C,F]})]}),e[76]=w,e[77]=C,e[78]=F,e[79]=D):D=e[79];let A;e[80]!==Te?(A=t.jsx("span",{className:"font-semibold text-foreground",children:Te}),e[80]=Te,e[81]=A):A=e[81];let I;e[82]!==d.length?(I=t.jsx("span",{className:"font-semibold text-foreground",children:d.length}),e[82]=d.length,e[83]=I):I=e[83];let E;e[84]!==A||e[85]!==I?(E=t.jsx("div",{className:"rounded-lg border bg-card p-4",children:t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing"," ",A," ","stores â€¢"," ",I," ","entities"]})}),e[84]=A,e[85]=I,e[86]=E):E=e[86];let _e;e[87]===Symbol.for("react.memo_cache_sentinel")?(_e=t.jsx("th",{rowSpan:2,className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground sticky left-0 bg-muted/50 z-10",style:{minWidth:120},children:"Store"}),e[87]=_e):_e=e[87];let G;e[88]!==m?(G=m.map(Ye),e[88]=m,e[89]=G):G=e[89];let je,ye;e[90]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsx("th",{rowSpan:2,className:"text-center align-middle font-bold",children:"Score Without Auto Fail"}),ye=t.jsx("th",{rowSpan:2,className:"text-center align-middle font-bold",children:"Total Score"}),e[90]=je,e[91]=ye):(je=e[90],ye=e[91]);let $;e[92]!==G?($=t.jsxs("tr",{children:[_e,G,je,ye]}),e[92]=G,e[93]=$):$=e[93];let L;e[94]!==m?(L=t.jsx("tr",{children:m.map(Qe)}),e[94]=m,e[95]=L):L=e[95];let z;e[96]!==$||e[97]!==L?(z=t.jsxs("thead",{className:"border-b bg-muted/50",children:[$,L]}),e[96]=$,e[97]=L,e[98]=z):z=e[98];let H;e[99]!==m||e[100]!==d.length||e[101]!==h||e[102]!==B?(H=B.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:d.length+3,className:"h-24 text-center text-muted-foreground",children:"No data found. Try adjusting your filters."})}):B.map(s=>t.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50",children:[t.jsxs("td",{className:"p-4 align-middle sticky left-0 bg-background z-10",children:[t.jsx("div",{className:"font-medium",children:s.store_name}),s.store_group&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:["Group ",s.store_group]})]}),m.map(f=>f.entities.map(Ne=>{const u=Me(s,Ne.id);return t.jsx("td",{className:"p-4 align-middle text-center",children:u?t.jsx("div",{className:"text-xs whitespace-pre-line",children:u}):t.jsx("span",{className:"text-muted-foreground",children:"-"})},Ne.id)})),t.jsx("td",{className:"p-4 align-middle text-center",children:h[s.store_id]?.score_without_auto_fail!==null?h[s.store_id]?.score_without_auto_fail:t.jsx("span",{className:"text-muted-foreground",children:"-"})}),t.jsx("td",{className:"p-4 align-middle text-center",children:typeof h[s.store_id]?.score_with_auto_fail=="number"?h[s.store_id].score_with_auto_fail:t.jsx("span",{className:"text-muted-foreground",children:"-"})})]},s.store_id)),e[99]=m,e[100]=d.length,e[101]=h,e[102]=B,e[103]=H):H=e[103];let M;e[104]!==H?(M=t.jsx("tbody",{children:H}),e[104]=H,e[105]=M):M=e[105];let U;e[106]!==z||e[107]!==M?(U=t.jsx("div",{className:"rounded-lg border bg-card overflow-x-auto",children:t.jsxs("table",{className:"w-full caption-bottom text-sm border-separate border-spacing-0",children:[z,M]})}),e[106]=z,e[107]=M,e[108]=U):U=e[108];let W;e[109]!==D||e[110]!==E||e[111]!==U||e[112]!==g?(W=t.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-4 pt-0",children:[g,D,E,U]}),e[109]=D,e[110]=E,e[111]=U,e[112]=g,e[113]=W):W=e[113];let ve;return e[114]!==p.user||e[115]!==W?(ve=t.jsxs(Oe,{user:Ue,children:[K,W]}),e[114]=p.user,e[115]=W,e[116]=ve):ve=e[116],ve}function Qe(l){return l.entities.map(Xe)}function Xe(l){return t.jsx("th",{className:"h-12 px-4 text-center align-middle font-medium text-muted-foreground",children:t.jsx("span",{children:l.entity_label})},l.id)}function Ye(l){return t.jsx("th",{className:"text-center align-middle font-bold bg-muted/50 text-[15px]",colSpan:l.entities.length,children:l.label},l.label)}function Ze(l){return t.jsx("option",{value:l.id,children:l.label??`Rating #${l.id}`},l.id)}function et(l){return t.jsxs("option",{value:l,children:["Group ",l]},l)}function tt(l){return t.jsx("option",{value:l.id,children:l.store},l.id)}function st(l,e){const p=l.entities[e];return p?p.rating_counts.filter(rt).map(lt).join(", "):""}function lt(l){return`${l.count} ${l.rating_label||"No Rating"}`}function rt(l){return l.count>0}export{ut as default};
