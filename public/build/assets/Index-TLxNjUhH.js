import{c as Fe,r as p,j as t,a as R,H as De}from"./app-BQRJ0j_D.js";import{X as ue,F as Ie,A as $e}from"./app-layout-DmC8kEH5.js";import{S as pe,P as ve}from"./save-D0TpIlZW.js";import{F as Te}from"./file-text-DlhiiXNY.js";import{S as Ne,T as Se}from"./trash-2-UJ5lp4iA.js";import"./app-CGKmwihm.js";import"./button-CiWo4oFx.js";import"./index-eVsFUjm_.js";import"./index-Bn9IGVAo.js";import"./index-AaGKiXUI.js";function Ve(n){const e=Fe.c(94),{auth:ge,entities:b,categories:o}=n,[f,he]=p.useState(!1),[x,be]=p.useState(null);let U;e[0]===Symbol.for("react.memo_cache_sentinel")?(U={label:"",sort_order:""},e[0]=U):U=e[0];const[c,W]=p.useState(U);let q;e[1]===Symbol.for("react.memo_cache_sentinel")?(q={label:"",sort_order:""},e[1]=q):q=e[1];const[m,M]=p.useState(q),[y,fe]=p.useState(!1),[u,ye]=p.useState(null);let L;e[2]===Symbol.for("react.memo_cache_sentinel")?(L={entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:""},e[2]=L):L=e[2];const[a,h]=p.useState(L);let O;e[3]===Symbol.for("react.memo_cache_sentinel")?(O={entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:""},e[3]=O):O=e[3];const[s,g]=p.useState(O);let X;e[4]===Symbol.for("react.memo_cache_sentinel")?(X={},e[4]=X):X=e[4];const[z,i]=p.useState(X);let B;e[5]!==c.label||e[6]!==c.sort_order?(B=r=>{r.preventDefault(),R.post("/categories",{label:c.label,sort_order:c.sort_order||null},{preserveScroll:!0,onSuccess:()=>{W({label:"",sort_order:""}),he(!1),i({})},onError:l=>i(l)})},e[5]=c.label,e[6]=c.sort_order,e[7]=B):B=e[7];const je=B;let G;e[8]===Symbol.for("react.memo_cache_sentinel")?(G=r=>{be(r.id),M({label:r.label,sort_order:r.sort_order?.toString()||""}),i({})},e[8]=G):G=e[8];const Ce=G;let J;e[9]!==m||e[10]!==x?(J=r=>{r.preventDefault(),x&&R.put(`/categories/${x}`,{label:m.label,sort_order:m.sort_order||null},{preserveScroll:!0,onSuccess:()=>{be(null),M({label:"",sort_order:""}),i({})},onError:l=>i(l)})},e[9]=m,e[10]=x,e[11]=J):J=e[11];const P=J,we=Ue;let K;e[12]!==a?(K=r=>{r.preventDefault(),R.post("/entities",{...a,category_id:a.category_id||null,report_type:a.report_type||null,sort_order:a.sort_order||null},{preserveScroll:!0,onSuccess:()=>{h({entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:""}),fe(!1),i({})},onError:l=>i(l)})},e[12]=a,e[13]=K):K=e[13];const _e=K;let Q;e[14]===Symbol.for("react.memo_cache_sentinel")?(Q=r=>{ye(r.id),g({entity_label:r.entity_label,category_id:r.category_id?.toString()||"",date_range_type:r.date_range_type,report_type:r.report_type||"",sort_order:r.sort_order?.toString()||""}),i({})},e[14]=Q):Q=e[14];const ke=Q;let V;e[15]!==s||e[16]!==u?(V=r=>{r.preventDefault(),u&&R.put(`/entities/${u}`,{...s,category_id:s.category_id||null,report_type:s.report_type||null,sort_order:s.sort_order||null},{preserveScroll:!0,onSuccess:()=>{ye(null),g({entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:""}),i({})},onError:l=>i(l)})},e[15]=s,e[16]=u,e[17]=V):V=e[17];const H=V,Ee=Pe,Ae=ge.user;let Y;e[18]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx(De,{title:"Entities & Categories"}),e[18]=Y):Y=e[18];let Z;e[19]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Entities & Categories"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage inspection entities and their categories"})]}),e[19]=Z):Z=e[19];let ee,te;e[20]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx("div",{className:"rounded-full bg-primary/10 p-3",children:t.jsx(Ie,{className:"h-5 w-5 text-primary"})}),te=t.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Total Categories"}),e[20]=ee,e[21]=te):(ee=e[20],te=e[21]);let j;e[22]!==o.length?(j=t.jsx("div",{className:"rounded-lg border bg-card p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[ee,t.jsxs("div",{children:[te,t.jsx("p",{className:"text-2xl font-bold",children:o.length})]})]})}),e[22]=o.length,e[23]=j):j=e[23];let re,le;e[24]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx("div",{className:"rounded-full bg-accent/50 p-3",children:t.jsx(Te,{className:"h-5 w-5 text-accent-foreground"})}),le=t.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Total Entities"}),e[24]=re,e[25]=le):(re=e[24],le=e[25]);let _;e[26]!==b.length?(_=t.jsx("div",{className:"rounded-lg border bg-card p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[re,t.jsxs("div",{children:[le,t.jsx("p",{className:"text-2xl font-bold",children:b.length})]})]})}),e[26]=b.length,e[27]=_):_=e[27];let v;e[28]!==j||e[29]!==_?(v=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[j,_]}),e[28]=j,e[29]=_,e[30]=v):v=e[30];let se,ae;e[31]===Symbol.for("react.memo_cache_sentinel")?(se=t.jsx("h3",{className:"text-lg font-semibold",children:"Categories"}),ae=()=>he(!0),e[31]=se,e[32]=ae):(se=e[31],ae=e[32]);let ne;e[33]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx(ve,{className:"h-3 w-3"}),e[33]=ne):ne=e[33];let N;e[34]!==f?(N=t.jsxs("div",{className:"bg-muted/50 px-6 py-4 border-b flex items-center justify-between",children:[se,t.jsxs("button",{onClick:ae,disabled:f,className:"inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[ne,"Add"]})]}),e[34]=f,e[35]=N):N=e[35];let oe;e[36]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx("thead",{className:"border-b sticky top-0 bg-background",children:t.jsxs("tr",{children:[t.jsx("th",{className:"h-10 px-4 text-left font-medium text-muted-foreground",children:"Category Name"}),t.jsx("th",{className:"h-10 px-4 text-center font-medium text-muted-foreground",children:"Entities"}),t.jsx("th",{className:"h-10 px-4 text-right font-medium text-muted-foreground",children:"Actions"})]})}),e[36]=oe):oe=e[36];let S;e[37]!==z||e[38]!==je||e[39]!==f||e[40]!==c?(S=f&&t.jsxs("tr",{className:"border-b bg-accent/5",children:[t.jsx("td",{className:"p-3",colSpan:2,children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",placeholder:"Category name",value:c.label,onChange:r=>W({...c,label:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",autoFocus:!0}),t.jsx("input",{type:"number",placeholder:"Sort order (optional)",value:c.sort_order,onChange:r=>W({...c,sort_order:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",min:"0"}),z.label&&t.jsx("p",{className:"text-xs text-destructive mt-1",children:z.label})]})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:je,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground hover:bg-primary/90",children:t.jsx(pe,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>{he(!1),W({label:"",sort_order:""}),i({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border hover:bg-accent",children:t.jsx(ue,{className:"h-3 w-3"})})]})})]}),e[37]=z,e[38]=je,e[39]=f,e[40]=c,e[41]=S):S=e[41];let C;if(e[42]!==o||e[43]!==m||e[44]!==x||e[45]!==P){let r;e[47]!==m||e[48]!==x||e[49]!==P?(r=l=>t.jsx("tr",{className:"border-b hover:bg-muted/50",children:x===l.id?t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"p-3",colSpan:2,children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",value:m.label,onChange:d=>M({...m,label:d.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"}),t.jsx("input",{type:"number",placeholder:"Sort order (optional)",value:m.sort_order,onChange:d=>M({...m,sort_order:d.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",min:"0"})]})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:P,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground",children:t.jsx(pe,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>{be(null),M({label:"",sort_order:""}),i({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border",children:t.jsx(ue,{className:"h-3 w-3"})})]})})]}):t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"p-3 font-medium",children:l.label}),t.jsx("td",{className:"p-3 text-center",children:t.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-muted",children:l.entities_count||0})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:()=>Ce(l),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-primary hover:bg-primary/10",children:t.jsx(Ne,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>we(l.id,l.label),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-destructive hover:bg-destructive/10",children:t.jsx(Se,{className:"h-3 w-3"})})]})})]})},l.id),e[47]=m,e[48]=x,e[49]=P,e[50]=r):r=e[50],C=o.map(r),e[42]=o,e[43]=m,e[44]=x,e[45]=P,e[46]=C}else C=e[46];let w;e[51]!==S||e[52]!==C?(w=t.jsx("div",{className:"overflow-auto max-h-[600px]",children:t.jsxs("table",{className:"w-full text-sm",children:[oe,t.jsxs("tbody",{children:[S,C]})]})}),e[51]=S,e[52]=C,e[53]=w):w=e[53];let k;e[54]!==N||e[55]!==w?(k=t.jsxs("div",{className:"rounded-lg border bg-card",children:[N,w]}),e[54]=N,e[55]=w,e[56]=k):k=e[56];let ie,de;e[57]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx("h3",{className:"text-lg font-semibold",children:"Entities"}),de=()=>fe(!0),e[57]=ie,e[58]=de):(ie=e[57],de=e[58]);let ce;e[59]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(ve,{className:"h-3 w-3"}),e[59]=ce):ce=e[59];let E;e[60]!==y?(E=t.jsxs("div",{className:"bg-muted/50 px-6 py-4 border-b flex items-center justify-between",children:[ie,t.jsxs("button",{onClick:de,disabled:y,className:"inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[ce,"Add"]})]}),e[60]=y,e[61]=E):E=e[61];let me;e[62]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx("thead",{className:"border-b sticky top-0 bg-background",children:t.jsxs("tr",{children:[t.jsx("th",{className:"h-10 px-4 text-left font-medium text-muted-foreground",children:"Entity Name"}),t.jsx("th",{className:"h-10 px-4 text-left font-medium text-muted-foreground",children:"Category"}),t.jsx("th",{className:"h-10 px-4 text-right font-medium text-muted-foreground",children:"Actions"})]})}),e[62]=me):me=e[62];let A;e[63]!==o||e[64]!==_e||e[65]!==y||e[66]!==a?(A=y&&t.jsx("tr",{className:"border-b bg-accent/5",children:t.jsx("td",{className:"p-3",colSpan:3,children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",placeholder:"Entity name",value:a.entity_label,onChange:r=>h({...a,entity_label:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",autoFocus:!0}),t.jsxs("select",{value:a.category_id,onChange:r=>h({...a,category_id:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Select category"}),o.map(Me)]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("select",{value:a.date_range_type,onChange:r=>h({...a,date_range_type:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"daily",children:"Daily"}),t.jsx("option",{value:"weekly",children:"Weekly"})]}),t.jsxs("select",{value:a.report_type,onChange:r=>h({...a,report_type:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Report type"}),t.jsx("option",{value:"main",children:"Main"}),t.jsx("option",{value:"secondary",children:"Secondary"})]})]}),t.jsx("input",{type:"number",placeholder:"Sort order (optional)",value:a.sort_order,onChange:r=>h({...a,sort_order:r.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",min:"0"}),t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsxs("button",{onClick:_e,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground",children:[t.jsx(pe,{className:"h-3 w-3"})," Save"]}),t.jsxs("button",{onClick:()=>{fe(!1),h({entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:""}),i({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border",children:[t.jsx(ue,{className:"h-3 w-3"})," Cancel"]})]})]})})}),e[63]=o,e[64]=_e,e[65]=y,e[66]=a,e[67]=A):A=e[67];let F;if(e[68]!==o||e[69]!==s||e[70]!==u||e[71]!==b||e[72]!==H){let r;e[74]!==o||e[75]!==s||e[76]!==u||e[77]!==H?(r=l=>t.jsx("tr",{className:"border-b hover:bg-muted/50",children:u===l.id?t.jsx("td",{className:"p-3",colSpan:3,children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",value:s.entity_label,onChange:d=>g({...s,entity_label:d.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm"}),t.jsxs("select",{value:s.category_id,onChange:d=>g({...s,category_id:d.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Select category"}),o.map(Re)]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("select",{value:s.date_range_type,onChange:d=>g({...s,date_range_type:d.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"daily",children:"Daily"}),t.jsx("option",{value:"weekly",children:"Weekly"})]}),t.jsxs("select",{value:s.report_type,onChange:d=>g({...s,report_type:d.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",children:[t.jsx("option",{value:"",children:"Report type"}),t.jsx("option",{value:"main",children:"Main"}),t.jsx("option",{value:"secondary",children:"Secondary"})]})]}),t.jsx("input",{type:"number",placeholder:"Sort order (optional)",value:s.sort_order,onChange:d=>g({...s,sort_order:d.target.value}),className:"flex h-8 w-full rounded-md border border-input bg-background px-2 text-sm",min:"0"}),t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:H,className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-primary text-primary-foreground",children:t.jsx(pe,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>{ye(null),g({entity_label:"",category_id:"",date_range_type:"daily",report_type:"",sort_order:""}),i({})},className:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-md border",children:t.jsx(ue,{className:"h-3 w-3"})})]})]})}):t.jsxs(t.Fragment,{children:[t.jsxs("td",{className:"p-3 font-medium",children:[l.entity_label,t.jsxs("div",{className:"flex gap-1 mt-1",children:[t.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-muted",children:l.date_range_type}),l.report_type&&t.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-accent/30",children:l.report_type})]})]}),t.jsx("td",{className:"p-3",children:l.category?t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-primary/10 text-primary",children:l.category.label}):t.jsx("span",{className:"text-xs text-muted-foreground",children:"No category"})}),t.jsx("td",{className:"p-3 text-right",children:t.jsxs("div",{className:"flex justify-end gap-1",children:[t.jsx("button",{onClick:()=>ke(l),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-primary hover:bg-primary/10",children:t.jsx(Ne,{className:"h-3 w-3"})}),t.jsx("button",{onClick:()=>Ee(l.id,l.entity_label),className:"inline-flex items-center px-2 py-1 text-xs rounded-md text-destructive hover:bg-destructive/10",children:t.jsx(Se,{className:"h-3 w-3"})})]})})]})},l.id),e[74]=o,e[75]=s,e[76]=u,e[77]=H,e[78]=r):r=e[78],F=b.map(r),e[68]=o,e[69]=s,e[70]=u,e[71]=b,e[72]=H,e[73]=F}else F=e[73];let D;e[79]!==A||e[80]!==F?(D=t.jsx("div",{className:"overflow-auto max-h-[600px]",children:t.jsxs("table",{className:"w-full text-sm",children:[me,t.jsxs("tbody",{children:[A,F]})]})}),e[79]=A,e[80]=F,e[81]=D):D=e[81];let I;e[82]!==E||e[83]!==D?(I=t.jsxs("div",{className:"rounded-lg border bg-card",children:[E,D]}),e[82]=E,e[83]=D,e[84]=I):I=e[84];let $;e[85]!==k||e[86]!==I?($=t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[k,I]}),e[85]=k,e[86]=I,e[87]=$):$=e[87];let T;e[88]!==v||e[89]!==$?(T=t.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-4 pt-0",children:[Z,v,$]}),e[88]=v,e[89]=$,e[90]=T):T=e[90];let xe;return e[91]!==ge.user||e[92]!==T?(xe=t.jsxs($e,{user:Ae,children:[Y,T]}),e[91]=ge.user,e[92]=T,e[93]=xe):xe=e[93],xe}function Re(n){return t.jsx("option",{value:n.id,children:n.label},n.id)}function Me(n){return t.jsx("option",{value:n.id,children:n.label},n.id)}function Pe(n,e){confirm(`Delete entity "${e}"?`)&&R.delete(`/entities/${n}`,{preserveScroll:!0,onError:He})}function He(n){return alert(n.error||"Failed to delete")}function Ue(n,e){confirm(`Delete category "${e}"?`)&&R.delete(`/categories/${n}`,{preserveScroll:!0,onError:We})}function We(n){return alert(n.error||"Failed to delete")}export{Ve as default};
