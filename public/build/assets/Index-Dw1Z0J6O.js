import{c as ze,r as ae,j as t,a as We,H as He}from"./app-BadiWaSs.js";import{A as Le}from"./app-layout-BuCdpd-i.js";import{c as Ge}from"./button-CKr5lld1.js";import{R as Ue}from"./refresh-cw-C6OpPcKx.js";import"./app-C9tB_R4V.js";import"./index-DVu5SrsQ.js";import"./index-CD-z6n7V.js";import"./index-BH0NSEIh.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Oe=Ge("Download",Me);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Pe=Ge("Filter",qe);function ut(s){const e=ze.c(128),{auth:S,reportData:w,stores:le,groups:re,filters:j}=s,[r,Ae]=ae.useState(j.report_type||""),[o,Re]=ae.useState(j.store_id||""),[n,Te]=ae.useState(j.group||"");let ce;e[0]!==j.year?(ce=j.year||new Date().getFullYear(),e[0]=j.year,e[1]=ce):ce=e[1];const[a,De]=ae.useState(ce),[c,Fe]=ae.useState(j.week||1);let de;e[2]!==n||e[3]!==r||e[4]!==o||e[5]!==c||e[6]!==a?(de=()=>{We.get("/camera-reports",{report_type:r,store_id:o,group:n,year:a,week:c},{preserveState:!0,preserveScroll:!0})},e[2]=n,e[3]=r,e[4]=o,e[5]=c,e[6]=a,e[7]=de):de=e[7];const oe=de;let me;e[8]===Symbol.for("react.memo_cache_sentinel")?(me=()=>{Ae(""),Re(""),Te(""),De(new Date().getFullYear()),Fe(1),We.get("/camera-reports")},e[8]=me):me=e[8];const Ie=me;let ue;e[9]!==n||e[10]!==w||e[11]!==r||e[12]!==o||e[13]!==c||e[14]!==a?(ue=()=>{const{summary:Y,entities:z}=w;let d="data:text/csv;charset=utf-8,";const H="Store,Group,"+z.map(lt).join(",")+",Score Without Auto Fail,Total Score";d=d+(encodeURIComponent(H)+"%0A"),Y.forEach(f=>{let i=`"${f.store_name}",${f.store_group||""}`;z.forEach(O=>{const N=f.entities[O.id];if(N){const _=N.rating_counts.filter(st).map(tt).join("; ");i=i+`,"${_||"-"}"`}else i=i+",-"});const b=w.scoreData[f.store_id]?.score_without_auto_fail??"-",M=w.scoreData[f.store_id]?.score_with_auto_fail??"-";i=i+`,${b},${M}`,d=d+(encodeURIComponent(i)+"%0A")});const m=document.createElement("a");m.setAttribute("href",d);const L=new Date().toISOString().split("T")[0],u=[];r&&u.push(`Type-${r}`),o&&u.push(`Store-${o}`),n&&u.push(`Group-${n}`),u.push(`Week-${c}-${a}`);const U=`camera-report-${u.join("_")}_${L}.csv`;m.setAttribute("download",U),document.body.appendChild(m),m.click(),document.body.removeChild(m)},e[9]=n,e[10]=w,e[11]=r,e[12]=o,e[13]=c,e[14]=a,e[15]=ue):ue=e[15];const ne=ue,Ye=Xe,{summary:fe,entities:y,total_stores:ie,scoreData:k}=w;let $,p,x,h,C,g,A,R,T,D,F;if(e[16]!==oe||e[17]!==S.user||e[18]!==y||e[19]!==ne||e[20]!==n||e[21]!==re||e[22]!==r||e[23]!==k||e[24]!==o||e[25]!==le||e[26]!==fe||e[27]!==ie||e[28]!==c||e[29]!==a){const Y={};y.forEach(l=>{const Ce=l.category?.id??0,v=l.category?.label??"Uncategorized";Y[v]||(Y[v]={id:Ce,label:v,entities:[]}),Y[v].entities.push(l)});const z=Object.values(Y);$=Le,C=S.user,e[41]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx(He,{title:"Camera Reports"}),e[41]=g):g=e[41],F="flex flex-1 flex-col gap-6 p-4 pt-0";let d;e[42]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Camera Reports"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Summary of ratings per store and entity"})]}),e[42]=d):d=e[42];let H;e[43]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx(Oe,{className:"h-4 w-4"}),e[43]=H):H=e[43],e[44]!==ne?(p=t.jsxs("div",{className:"flex items-center justify-between",children:[d,t.jsxs("button",{onClick:ne,className:"inline-flex items-center gap-2 justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90 transition-colors",children:[H,"Export"]})]}),e[44]=ne,e[45]=p):p=e[45];let m;e[46]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-accent/10 px-6 py-4 border-b",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Pe,{className:"h-5 w-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"Filters"})]})}),e[46]=m):m=e[46];let L;e[47]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx("label",{className:"text-sm font-medium",children:"Report Type"}),e[47]=L):L=e[47];let u;e[48]===Symbol.for("react.memo_cache_sentinel")?(u=l=>Ae(l.target.value),e[48]=u):u=e[48];let U,f,i;e[49]===Symbol.for("react.memo_cache_sentinel")?(U=t.jsx("option",{value:"",children:"All Types"}),f=t.jsx("option",{value:"main",children:"Main"}),i=t.jsx("option",{value:"secondary",children:"Secondary"}),e[49]=U,e[50]=f,e[51]=i):(U=e[49],f=e[50],i=e[51]);let b;e[52]!==r?(b=t.jsxs("div",{className:"space-y-2",children:[L,t.jsxs("select",{value:r,onChange:u,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[U,f,i]})]}),e[52]=r,e[53]=b):b=e[53];let M;e[54]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx("label",{className:"text-sm font-medium",children:"Store"}),e[54]=M):M=e[54];let O;e[55]===Symbol.for("react.memo_cache_sentinel")?(O=l=>Re(l.target.value),e[55]=O):O=e[55];let N;e[56]===Symbol.for("react.memo_cache_sentinel")?(N=t.jsx("option",{value:"",children:"All Stores"}),e[56]=N):N=e[56];let _;e[57]!==le?(_=le.map(Qe),e[57]=le,e[58]=_):_=e[58];let q;e[59]!==o||e[60]!==_?(q=t.jsxs("div",{className:"space-y-2",children:[M,t.jsxs("select",{value:o,onChange:O,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[N,_]})]}),e[59]=o,e[60]=_,e[61]=q):q=e[61];let xe;e[62]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsx("label",{className:"text-sm font-medium",children:"Group"}),e[62]=xe):xe=e[62];let he;e[63]===Symbol.for("react.memo_cache_sentinel")?(he=l=>Te(l.target.value),e[63]=he):he=e[63];let ge;e[64]===Symbol.for("react.memo_cache_sentinel")?(ge=t.jsx("option",{value:"",children:"All Groups"}),e[64]=ge):ge=e[64];let P;e[65]!==re?(P=re.map(Ke),e[65]=re,e[66]=P):P=e[66];let V;e[67]!==n||e[68]!==P?(V=t.jsxs("div",{className:"space-y-2",children:[xe,t.jsxs("select",{value:n,onChange:he,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[ge,P]})]}),e[67]=n,e[68]=P,e[69]=V):V=e[69];let B;e[70]!==b||e[71]!==q||e[72]!==V?(B=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[b,q,V]}),e[70]=b,e[71]=q,e[72]=V,e[73]=B):B=e[73];let be;e[74]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsx("label",{className:"text-sm font-medium",children:"Year"}),e[74]=be):be=e[74];let _e;e[75]===Symbol.for("react.memo_cache_sentinel")?(_e=l=>De(Number(l.target.value)),e[75]=_e):_e=e[75];let J;e[76]!==a?(J=t.jsxs("div",{className:"space-y-2",children:[be,t.jsx("input",{type:"number",value:a,onChange:_e,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"})]}),e[76]=a,e[77]=J):J=e[77];let je;e[78]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsx("label",{className:"text-sm font-medium",children:"Week"}),e[78]=je):je=e[78];let ye;e[79]===Symbol.for("react.memo_cache_sentinel")?(ye=l=>Fe(Number(l.target.value)),e[79]=ye):ye=e[79];let K;e[80]!==c?(K=t.jsx("input",{type:"number",min:1,max:53,value:c,onChange:ye,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"}),e[80]=c,e[81]=K):K=e[81];let Ne;e[82]===Symbol.for("react.memo_cache_sentinel")?(Ne=t.jsx("p",{className:"text-xs text-muted-foreground",children:"Weeks start on Tuesday"}),e[82]=Ne):Ne=e[82];let Q;e[83]!==K?(Q=t.jsxs("div",{className:"space-y-2",children:[je,K,Ne]}),e[83]=K,e[84]=Q):Q=e[84];let X;e[85]!==J||e[86]!==Q?(X=t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[J,Q]}),e[85]=J,e[86]=Q,e[87]=X):X=e[87];let ve;e[88]===Symbol.for("react.memo_cache_sentinel")?(ve=t.jsx(Ue,{className:"h-4 w-4"}),e[88]=ve):ve=e[88];let Z;e[89]!==oe?(Z=t.jsxs("button",{onClick:oe,className:"inline-flex items-center gap-2 justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow hover:bg-primary/90",children:[ve,"Apply Filters"]}),e[89]=oe,e[90]=Z):Z=e[90];let Se;e[91]===Symbol.for("react.memo_cache_sentinel")?(Se=t.jsx("button",{onClick:Ie,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground",children:"Reset"}),e[91]=Se):Se=e[91];let ee;e[92]!==Z?(ee=t.jsxs("div",{className:"flex gap-2 pt-2",children:[Z,Se]}),e[92]=Z,e[93]=ee):ee=e[93],e[94]!==B||e[95]!==X||e[96]!==ee?(x=t.jsxs("div",{className:"rounded-lg border bg-card",children:[m,t.jsxs("div",{className:"p-6 space-y-4",children:[B,X,ee]})]}),e[94]=B,e[95]=X,e[96]=ee,e[97]=x):x=e[97];let te;e[98]!==ie?(te=t.jsx("span",{className:"font-semibold text-foreground",children:ie}),e[98]=ie,e[99]=te):te=e[99];let se;e[100]!==y.length?(se=t.jsx("span",{className:"font-semibold text-foreground",children:y.length}),e[100]=y.length,e[101]=se):se=e[101],e[102]!==te||e[103]!==se?(h=t.jsx("div",{className:"rounded-lg border bg-card p-4",children:t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing"," ",te," ","stores â€¢"," ",se," ","entities"]})}),e[102]=te,e[103]=se,e[104]=h):h=e[104],D="rounded-lg border bg-card overflow-x-auto",R="w-full caption-bottom text-sm border-separate border-spacing-0";let we;e[105]===Symbol.for("react.memo_cache_sentinel")?(we=t.jsx("th",{rowSpan:2,className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground sticky left-0 bg-muted/50 z-10",style:{minWidth:120},children:"Store"}),e[105]=we):we=e[105];let ke,$e;e[106]===Symbol.for("react.memo_cache_sentinel")?(ke=t.jsx("th",{rowSpan:2,className:"text-center align-middle font-bold",children:"Score Without Auto Fail"}),$e=t.jsx("th",{rowSpan:2,className:"text-center align-middle font-bold",children:"Total Score"}),e[106]=ke,e[107]=$e):(ke=e[106],$e=e[107]),T=t.jsxs("thead",{className:"border-b bg-muted/50",children:[t.jsxs("tr",{children:[we,z.map(Je),ke,$e]}),t.jsx("tr",{children:z.map(Ve)})]}),A=fe.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:y.length+3,className:"h-24 text-center text-muted-foreground",children:"No data found. Try adjusting your filters."})}):fe.map(l=>t.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50",children:[t.jsxs("td",{className:"p-4 align-middle sticky left-0 bg-background z-10",children:[t.jsx("div",{className:"font-medium",children:l.store_name}),l.store_group&&t.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:["Group ",l.store_group]})]}),z.map(Ce=>Ce.entities.map(v=>{const Ee=Ye(l,v.id);return t.jsx("td",{className:"p-4 align-middle text-center",children:Ee?t.jsx("div",{className:"text-xs whitespace-pre-line",children:Ee}):t.jsx("span",{className:"text-muted-foreground",children:"-"})},v.id)})),t.jsx("td",{className:"p-4 align-middle text-center",children:k[l.store_id]?.score_without_auto_fail!==null?k[l.store_id]?.score_without_auto_fail:t.jsx("span",{className:"text-muted-foreground",children:"-"})}),t.jsx("td",{className:"p-4 align-middle text-center",children:typeof k[l.store_id]?.score_with_auto_fail=="number"?k[l.store_id].score_with_auto_fail:t.jsx("span",{className:"text-muted-foreground",children:"-"})})]},l.store_id)),e[16]=oe,e[17]=S.user,e[18]=y,e[19]=ne,e[20]=n,e[21]=re,e[22]=r,e[23]=k,e[24]=o,e[25]=le,e[26]=fe,e[27]=ie,e[28]=c,e[29]=a,e[30]=$,e[31]=p,e[32]=x,e[33]=h,e[34]=C,e[35]=g,e[36]=A,e[37]=R,e[38]=T,e[39]=D,e[40]=F}else $=e[30],p=e[31],x=e[32],h=e[33],C=e[34],g=e[35],A=e[36],R=e[37],T=e[38],D=e[39],F=e[40];let E;e[108]!==A?(E=t.jsx("tbody",{children:A}),e[108]=A,e[109]=E):E=e[109];let W;e[110]!==E||e[111]!==R||e[112]!==T?(W=t.jsxs("table",{className:R,children:[T,E]}),e[110]=E,e[111]=R,e[112]=T,e[113]=W):W=e[113];let G;e[114]!==W||e[115]!==D?(G=t.jsx("div",{className:D,children:W}),e[114]=W,e[115]=D,e[116]=G):G=e[116];let I;e[117]!==p||e[118]!==x||e[119]!==h||e[120]!==G||e[121]!==F?(I=t.jsxs("div",{className:F,children:[p,x,h,G]}),e[117]=p,e[118]=x,e[119]=h,e[120]=G,e[121]=F,e[122]=I):I=e[122];let pe;return e[123]!==$||e[124]!==C||e[125]!==g||e[126]!==I?(pe=t.jsxs($,{user:C,children:[g,I]}),e[123]=$,e[124]=C,e[125]=g,e[126]=I,e[127]=pe):pe=e[127],pe}function Ve(s){return s.entities.map(Be)}function Be(s){return t.jsx("th",{className:"h-12 px-4 text-center align-middle font-medium text-muted-foreground",children:t.jsx("span",{children:s.entity_label})},s.id)}function Je(s){return t.jsx("th",{className:"text-center align-middle font-bold bg-muted/50 text-[15px]",colSpan:s.entities.length,children:s.label},s.label)}function Ke(s){return t.jsxs("option",{value:s,children:["Group ",s]},s)}function Qe(s){return t.jsx("option",{value:s.id,children:s.store},s.id)}function Xe(s,e){const S=s.entities[e];return S?S.rating_counts.filter(et).map(Ze).join(", "):""}function Ze(s){return`${s.count} ${s.rating_label||"No Rating"}`}function et(s){return s.count>0}function tt(s){return`${s.count} ${s.rating_label||"No Rating"}`}function st(s){return s.count>0}function lt(s){return s.entity_label}export{ut as default};
